---
import type { GetStaticPaths, Page } from 'astro'
import { allBooks } from '@/content'
import type { LibraryData } from 'content-schema'
import { FloatImage, MediaListItem, Pagination } from 'ui'
import MainLayout from '@/layouts/MainLayout.astro'

export const getStaticPaths = (({ paginate }) => {
  const books = allBooks.data.library
  return paginate(books, {
    pageSize: 10
  })
}) satisfies GetStaticPaths

interface Props {
  page: Page<LibraryData>
}

const { page } = Astro.props

const books = page.data
---

<MainLayout title="Бібліотека" description="Бібліотека">
  <div class="not-prose">
    <h1 class="mb-10 text-3xl font-bold">Бібліоткеа</h1>
    {
      books.map(book => (
        <MediaListItem href={book.href}>
          <div slot="header" class="">
            <h2 class="text-2xl font-bold">{book.title}</h2>
            <p class="text-base opacity-40">{book.date}</p>
          </div>
          <FloatImage slot="left" src={book.imgSrc} alt={book.title} />
          <span
            slot="right"
            class="text-base italic hover:underline hover:underline-offset-4"
          >
            Читати далі
          </span>
        </MediaListItem>
      ))
    }
    <div class="mt-10">
      <Pagination
        next={page.url.next}
        prev={page.url.prev}
        current={page.currentPage}
        total={page.lastPage}
        baseUrl="/education/library/"
      />
    </div>
  </div>
</MainLayout>

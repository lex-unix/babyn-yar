---
import type { EventData } from '@/content/config'
import type { GetStaticPathsOptions, Page } from 'astro'
import { allEvents } from '@/content'
import { FloatImage, MediaListItem } from 'ui'
import BaseLayout from '@/layouts/BaseLayout.astro'
import { Pagination } from 'ui'

export function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const events = allEvents.data.events
  return paginate(events, { pageSize: 4 })
}

export type Props = {
  page: Page<EventData>
}

const { page } = Astro.props
const events = page.data
---

<BaseLayout
  content={{
    title: 'Events',
    description: 'View all events'
  }}
>
  <div class="not-prose">
    {
      events.map(({ title, description, slug, image, featured }) => (
        <MediaListItem
          href={slug}
          maxImgWidth={`${featured ? 'md:max-w-[480px]' : 'md:max-w-[400px]'}`}
        >
          <h2
            slot="header"
            class={`${featured ? 'text-3xl' : 'text-2xl'} font-bold text-black`}
          >
            {title}
          </h2>
          <FloatImage slot="left" src={image} alt={title} />

          <p
            slot="right"
            class={`${
              featured ? 'line-clamp-4' : 'line-clamp-2'
            } italic hover:underline hover:underline-offset-4`}
          >
            {description}
          </p>
        </MediaListItem>
      ))
    }
    <div class="mt-10">
      <Pagination
        next={page.url.next}
        prev={page.url.prev}
        current={page.currentPage}
        total={page.lastPage}
        baseUrl="/events/"
      />
    </div>
  </div>
</BaseLayout>

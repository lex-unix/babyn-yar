---
import { allTestimonies } from '@/content'
import MainLayout from '@/layouts/MainLayout.astro'
import type { GetStaticPaths, Page } from 'astro'
import type { TestimonyData } from 'content-schema'
import { FloatImage, MediaListItem, Pagination } from 'ui'

export const getStaticPaths = (({ paginate }) => {
  const testimonies = allTestimonies.data.testimonies
  return paginate(testimonies, { pageSize: 10 })
}) satisfies GetStaticPaths

interface Props {
  page: Page<TestimonyData>
}

const { page } = Astro.props
const testimonies = page.data
---

<MainLayout
  title="Eyewitnesses’ testimony"
  description="Eyewitnesses’ testimony"
>
  <div class="not-prose">
    <h1 class="mb-10 text-3xl font-bold">Eyewitnesses’ testimony</h1>
    {
      testimonies.map(testimony => (
        <MediaListItem href={testimony.href}>
          <div slot="header">
            <h2 class="text-2xl font-bold">{testimony.title}</h2>
            <p class="text-base opacity-60">{testimony.date}</p>
          </div>
          <FloatImage
            slot="left"
            src={testimony.imgSrc}
            alt={testimony.title}
          />
          <p slot="right" class="text-base">
            {testimony.description}
          </p>
        </MediaListItem>
      ))
    }
    <Pagination
      next={page.url.next}
      prev={page.url.prev}
      current={page.currentPage}
      total={page.lastPage}
      baseUrl="/holocaust/testimonies/"
    />
  </div>
</MainLayout>
